<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">
    <property name="now" value="sysdate" dbms="oracle"/>
    <property name="now" value="now()" dbms="mysql"/>
    <property name="now" value="now()" dbms="postgresql"/>

    <changeSet id="crate-table-20190727-0001" author="vista yih" >
        <createTable tableName="blog_sys_user" remarks="user table">
            <column name="id" type="BIGINT" remarks="user ID,primary key">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_blog_sys_user_id"/>
            </column>
            <column name="username" type="VARCHAR(100)" remarks="user name">
                <constraints nullable="false" />
            </column>
            <column name="password" type="VARCHAR(512)" remarks="password">
                <constraints nullable="false" />
            </column>

            <column name="create_by" type="BIGINT" remarks="create by" />
            <column name="create_time" type="DATETIME" remarks="crate time" defaultValueDate="${now}"/>
            <column name="last_update_by" type="BIGINT" remarks="last update by" />
            <column name="last_update_time" type="DATETIME" remarks="last update time" />
            <column name="object_version_number" type="BIGINT" remarks="object version number" />
        </createTable>

        <createTable tableName="blog_sys_role" remarks="role name">
            <column name="id" type="BIGINT" remarks="role id, primary key">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_blog_sys_role_id"/>
            </column>
            <column name="role_name" type="VARCHAR(128)" remarks="role name">
                <constraints nullable="false" />
            </column>

            <column name="create_by" type="BIGINT" remarks="create by" />
            <column name="create_time" type="DATETIME" remarks="crate time" defaultValueDate="${now}" />
            <column name="last_update_by" type="BIGINT" remarks="last update by" />
            <column name="last_update_time" type="DATETIME" remarks="last update time" />
            <column name="object_version_number" type="BIGINT" remarks="object version number" />
        </createTable>

        <createTable tableName="blog_sys_permission" remarks="permission table">
            <column name="id" type="BIGINT" remarks="permission id, primary key">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_blog_sys_permission_id" />
            </column>
            <column name="permission_name" type="VARCHAR(128)" remarks="permission_name">
                <constraints nullable="false" />
            </column>

            <column name="create_by" type="BIGINT" remarks="create by" />
            <column name="create_time" type="DATETIME" remarks="crate time" defaultValueDate="${now}" />
            <column name="last_update_by" type="BIGINT" remarks="last update by" />
            <column name="last_update_time" type="DATETIME" remarks="last update time" />
            <column name="object_version_number" type="BIGINT" remarks="object version number" />
        </createTable>

        <createTable tableName="blog_sys_user_role" remarks="User role association table">
            <column name="id" type="BIGINT" remarks="table id">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_blog_sys_user_role_id" />
            </column>
            <column name="user_id" type="BIGINT" remarks="user id">
                <constraints nullable="false" foreignKeyName="fk_user_role_to_user" references="blog_sys_user(id)" />
            </column>
            <column name="role_id" type="BIGINT" remarks="role id">
                <constraints nullable="false" foreignKeyName="fk_user_role_to_role" references="blog_sys_role(id)" />
            </column>

            <column name="create_by" type="BIGINT" remarks="create by" />
            <column name="create_time" type="DATETIME" remarks="crate time" defaultValueDate="${now}" />
            <column name="last_update_by" type="BIGINT" remarks="last update by" />
            <column name="last_update_time" type="DATETIME" remarks="last update time" />
            <column name="object_version_number" type="BIGINT" remarks="object version number" />
        </createTable>

        <createTable tableName="blog_sys_role_permission" remarks="role permission association table">
            <column name="id" type="BIGINT" remarks="table id">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_blog_sys_user_role_id" />
            </column>
            <column name="role_id" type="BIGINT" remarks="role id">
                <constraints nullable="false" foreignKeyName="fk_role_permission_to_role" references="blog_sys_role(id)" />
            </column>
            <column name="permission_id" type="BIGINT" remarks="permission id">
                <constraints nullable="false" foreignKeyName="fk_role_permission_to_permission" references="blog_sys_permission(id)" />
            </column>

            <column name="create_by" type="BIGINT" remarks="create by" />
            <column name="create_time" type="DATETIME" remarks="crate time" defaultValueDate="${now}" />
            <column name="last_update_by" type="BIGINT" remarks="last update by" />
            <column name="last_update_time" type="DATETIME" remarks="last update time" />
            <column name="object_version_number" type="BIGINT" remarks="object version number" />
        </createTable>

        <createTable tableName="blog_sys_user_info" remarks="user info">
            <column name="id" type="BIGINT" remarks="user id">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_blog_sys_user_info_id" foreignKeyName="fk_user_info_to_user" references="blog_sys_user(id)" />
            </column>
            <column name="describe" type="varchar(1024)" remarks="user describe" />
            <column name="first_name" type="VARCHAR(256)" remarks="first name" />
            <column name="last_name" type="VARCHAR(256)" remarks="last name" />

            <column name="create_by" type="BIGINT" remarks="create by" />
            <column name="create_time" type="DATETIME" remarks="crate time" defaultValueDate="${now}" />
            <column name="last_update_by" type="BIGINT" remarks="last update by" />
            <column name="last_update_time" type="DATETIME" remarks="last update time" />
            <column name="object_version_number" type="BIGINT" remarks="object version number" />
        </createTable>
    </changeSet>


    <changeSet id="insert-data-20190728-0002" author="vista yih">
        <insert tableName="blog_sys_user">
            <column name="id" valueNumeric="100001"/>
            <column name="username" value="admin" />
            <column name="password" value="123456"/>
        </insert>

        <insert tableName="blog_sys_user">
            <column name="id" valueNumeric="100002"/>
            <column name="username" value="vista yih" />
            <column name="password" value="123456"/>
        </insert>

        <insert tableName="blog_sys_user">
            <column name="id" valueNumeric="100003"/>
            <column name="username" value="vista yih" />
            <column name="password" value="123456"/>
        </insert>

        <insert tableName="blog_sys_user_info">
            <column name="id" valueNumeric="100001" />
            <column name="first_name" value="Vista" />
            <column name="last_name" value="Yih" />
        </insert>

    </changeSet>
</databaseChangeLog>